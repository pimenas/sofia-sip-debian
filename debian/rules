#!/usr/bin/make -f

NUM_CPUS = $(shell getconf _NPROCESSORS_ONLN 2>/dev/null)
PARALLEL = $(subst parallel=,,$(filter parallel=%,$(DEB_BUILD_OPTIONS)))
NJOBS    = $(or $(PARALLEL),$(NUM_CPUS),1)

DEB_BUILD_PARALLEL = 1
DEB_PARALLEL_JOBS := $(NJOBS)

include /usr/share/cdbs/1/rules/utils.mk
include /usr/share/cdbs/1/rules/debhelper.mk
include /usr/share/cdbs/1/class/autotools.mk

# not used:
#DEB_CONFIGURE_SCRIPT_ENV += LDFLAGS="-Wl,-z,defs,--as-needed"

DEB_MAKE_CLEAN_TARGET 		= clean
DEB_DH_INSTALL_SOURCEDIR 	= debian/tmp
DEB_INSTALL_DOCS_sofia-sip-doc  := libsofia-sip-ua/docs/html
DEB_DH_MAKESHLIBS_ARGS_ALL      := -- -c1

common-build-indep::
	$(MAKE) doxygen

common-binary-post-install-arch:: list-missing

clean::
	rm -Rf libsofia-sip-ua/docs/html
	rm -Rf libsofia-sip-ua-glib/docs/html

